"use strict";var _createClass=function(){function s(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}define(["SwiftOtter_Test/js/renderer/slide/next-button.babel","SwiftOtter_Test/js/renderer/slide/previous-button.babel","SwiftOtter_Test/js/api.babel","SwiftOtter_Test/js/token-management.babel"],function(t,e,s,l){function o(t){var e=this.el.querySelector(".login__error");e.style.display="block",e.innerHTML=t,function(){this.el.querySelector(".login").classList.remove("is-loading")}.call(this)}return function(){function n(t,e){_classCallCheck(this,n),this.config=t,this.data=e,this.api=new s(t)}return _createClass(n,[{key:"render",value:function(t,e,n){var s=function(t,e,n){var s='\n        <li class="test-question test-question--block test-question--'+this.data.output_type+" "+function(t,e){var n="";return 1===t?n="test-question--first":t===e&&(n="test-question--last"),n}.call(this,t,e)+" "+function(t){return 1!==t?"":" test-question--active"}.call(this,t)+'" data-question-id="'+this.data.id+'">\n            <div class="login-link">Login</div>\n            <div class="back-link" style="display:none">Back</div>\n            <form action="#" method="POST" class="login" style="display:none">\n                <label for="email" class="label">Email</label>\n                <input type="email" id="email" class="customer-form__field-input input-text"/>\n                \n                <label for="password" class="label">Password</label>\n                <input type="password" id="password" class="customer-form__field-input input-text"/>\n                \n                <div class="login__error" style="display: none"></div>\n                \n                <button class="login__go test-question__cta-button info-button">Login</button><br/>\n                <small>You can register on the payment form. <a href="/customer/account/forgotpassword" target="_blank">Forgot your password?</a></small>\n            </form>\n            <div class="welcome">\n              <h2 class="test-question__title">'+this.data.question+'</h2>\n              <div class="test-question__subtext">'+this.data.subtext+'</div>\n              <div class="test-question__buttons">\n                  <button class="test-question__next test-question__cta-button info-button test-question__go-to-next" data-question-id="'+this.data.id+'">Next '+window.jsonConfig.icons.next+'</button>\n                  <button class="test-question__next test-question__cta-button info-button test-question__go-to-pay" data-question-id="'+this.data.id+'">Pay '+window.jsonConfig.icons.next+'</button>\n                  <button class="test-question__next-first-question test-question__cta-button info-button test-question__start-with-free" data-question-id="'+this.data.id+'">Or, start for free</button>\n              </div>\n            </div>\n        </li>\n      ';return document.createRange().createContextualFragment(s)}.call(this,t,e,n);if(this.el=s.firstElementChild,this.el.querySelector(".login-link").addEventListener("click",function(t){this.el.querySelector(".login").style.display="block",this.el.querySelector(".back-link").style.display="block",this.el.querySelector(".login-link").style.display="none",this.el.querySelector(".welcome").style.display="none"}.bind(this)),this.el.querySelector(".back-link").addEventListener("click",function(t){this.el.querySelector(".login").style.display="none",this.el.querySelector(".back-link").style.display="none",this.el.querySelector(".login-link").style.display="block",this.el.querySelector(".welcome").style.display="block"}.bind(this)),this.el.querySelector(".login").addEventListener("submit",function(t){var n=this;t.preventDefault(),function(){this.el.querySelector(".login__error").style.display="none"}.call(this),function(){this.el.querySelector(".login").classList.add("is-loading")}.call(this);var e=this.el.querySelector("#email").value,s=this.el.querySelector("#password").value;return e||o.call(this,"You need to specify your email."),s||o.call(this,"You need to specify a password."),l.login(e,s).then(function(t){if(t.success){var e=new CustomEvent("test:refresh",{});document.body.dispatchEvent(e)}else o.call(n,t.error)})}.bind(this)),jsonConfig.logged_in){var i=this.el.querySelector(".test-question__title");i.innerText="Welcome, "+jsonConfig.customer_name,i.style.display="block",this.el.querySelector(".login-link").style.display="none"}return jsonConfig.all_features_available?(this.el.querySelector(".test-question__go-to-pay").style.display="none",this.el.querySelector(".test-question__start-with-free").style.display="none"):this.el.querySelector(".test-question__go-to-next").style.display="none",s}}]),n}()});